{% extends "index.html" %}

{% block content %}
<section>
    <div style="margin-top:2vh;margin-bottom:2vh;justify-content:center;align-items:center;display:flex">
        <form id="search" action="{{ url_for('wiki_search_results') }}" method="post">
            <label for="search">Search Wikipedia:</label>
            <input id="search" type="text" name="search_button">
            <input type="submit" />
            <label for="pages"># of pages</label>
            <select id="pages" name="pages">
                {% for myrange in range(5,301,5) %}
                <option value="{{myrange}}">{{myrange}}</option>
                {% endfor %}
            </select>
        </form>
        <form style="margin-left:25px" id="delete_db" action="{{ url_for('delete_db')}}" method="post">
            <input type="submit" id="delete" value="Delete DB/Start Over?"/>
        </form>
    </div>
</section>
{% endblock content %}
{% block search_results %}
<section>
    <div style="width:100vw">
        {% if db_content['pages'] %}
        <div id="table-wrapper">
            <div id="table-scroll">
                <table>
                    <tr style="position:sticky;top:0px">
                        <th>Wikipedia pages</th>
                        <th>Related Youtube links</th>
                    </tr>
                    <tbody>
                        {% for page in db_content['pages'] %}
                        <tr style="height:10vh;">
                            <td>
                                <div style="display:flex;">
                                    {% if page.thumbnail.url %}
                                    <a href="{{page.url}}" target="_blank"><img style="height:auto;" src="{{page.thumbnail['url']}}" width="{{page.thumbnail['width']}}" height="{{page.thumbnail['height']}}" /></a>
                                    <p>&nbsp&nbsp{{page.title}}</p>
                                    {% else %}
                                    <a href="{{page.url}}" target="_blank">{{page.title}}</a>
                                    {% endif %}
                                </div>
                            </td>
                            <td>
                                {% if page['youtube_videos'] %}
                                  <div style="height:10vh;overflow-y:scroll">
                                  {% for each_video in page['youtube_videos'] %}
                                    <div style="display:flex;">
                                        {% if page.thumbnail.url %}
                                        <a href="{{each_video.url}}" target="_blank"><img style="height:auto;" src="{{each_video.thumbnail['url']}}" width="{{each_video.thumbnail['width']}}" height="{{each_video.thumbnail['height']}}" /></a>
                                        <p>&nbsp&nbsp{{each_video.title}}</p>
                                        {% else %}
                                        <a href="{{each_video.url}}" target="_blank">{{each_video.title}}</a>
                                        {% endif %}
                                    </div>
                                  {% endfor %}
                                  </div>
                                {% else %}
                                <div>
                                    <p>No Youtube Videos found</p>
                                </div>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% else %}
        <h2 style="text-align:center">
            Database is currently empty
        </h2>
        <p style="text-align:center">Enter a search term to get back the desired number of result Wikipedia pages. <br /> Select which pages you want to save to the database and We will search and save any youtube entries found(up to 50) based on the title of the Wikipedia page.</p>
        {% endif %}
    </div>
</section>
{% endblock search_results %}

